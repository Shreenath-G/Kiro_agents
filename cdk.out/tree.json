{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.220.0"},"children":{"AdOptimizerAgentStack":{"id":"AdOptimizerAgentStack","path":"AdOptimizerAgentStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.220.0"},"children":{"CampaignDataBucket":{"id":"CampaignDataBucket","path":"AdOptimizerAgentStack/CampaignDataBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.220.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/CampaignDataBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"ad-optimizer-data-793323451177","lifecycleConfiguration":{"rules":[{"expirationInDays":90,"status":"Enabled","transitions":[{"storageClass":"STANDARD_IA","transitionInDays":30}]}]},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}],"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"AdOptimizerAgentStack/CampaignDataBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.220.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/CampaignDataBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"CampaignDataBucket2FED4F6D"},"policyDocument":{"Statement":[{"Action":["s3:PutBucketPolicy","s3:GetBucket*","s3:List*","s3:DeleteObject*"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["CampaignDataBucket2FED4F6D","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["CampaignDataBucket2FED4F6D","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"AdOptimizerAgentStack/CampaignDataBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.220.0","metadata":[]},"children":{"Default":{"id":"Default","path":"AdOptimizerAgentStack/CampaignDataBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.220.0"}}}}}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"AdOptimizerAgentStack/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.220.0"},"children":{"Staging":{"id":"Staging","path":"AdOptimizerAgentStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.220.0"}},"Role":{"id":"Role","path":"AdOptimizerAgentStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.220.0"}},"Handler":{"id":"Handler","path":"AdOptimizerAgentStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.220.0"}}}},"CampaignMetricsTable":{"id":"CampaignMetricsTable","path":"AdOptimizerAgentStack/CampaignMetricsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.220.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/CampaignMetricsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"campaignId","attributeType":"S"},{"attributeName":"timestamp","attributeType":"N"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"campaignId","keyType":"HASH"},{"attributeName":"timestamp","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":true},"tableName":"ad-optimizer-metrics","timeToLiveSpecification":{"attributeName":"ttl","enabled":true}}}},"ScalingRole":{"id":"ScalingRole","path":"AdOptimizerAgentStack/CampaignMetricsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.220.0","metadata":[]}}}},"AdPlatformAPIKeys":{"id":"AdPlatformAPIKeys","path":"AdOptimizerAgentStack/AdPlatformAPIKeys","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.220.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/AdPlatformAPIKeys/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"API keys for Google Ads and Meta Ads","generateSecretString":{"secretStringTemplate":"{\"googleAdsClientId\":\"REPLACE_WITH_YOUR_CLIENT_ID\",\"googleAdsClientSecret\":\"REPLACE_WITH_YOUR_CLIENT_SECRET\",\"googleAdsRefreshToken\":\"REPLACE_WITH_YOUR_REFRESH_TOKEN\",\"googleAdsDeveloperToken\":\"REPLACE_WITH_YOUR_DEVELOPER_TOKEN\",\"metaAccessToken\":\"REPLACE_WITH_YOUR_META_ACCESS_TOKEN\",\"metaAdAccountId\":\"REPLACE_WITH_YOUR_AD_ACCOUNT_ID\"}","generateStringKey":"placeholder"},"name":"ad-optimizer/api-keys"}}}}},"GoogleAdsFunction":{"id":"GoogleAdsFunction","path":"AdOptimizerAgentStack/GoogleAdsFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.220.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"AdOptimizerAgentStack/GoogleAdsFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.220.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"AdOptimizerAgentStack/GoogleAdsFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.220.0","metadata":[]}},"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/GoogleAdsFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"AdOptimizerAgentStack/GoogleAdsFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.220.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/GoogleAdsFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CampaignDataBucket2FED4F6D","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["CampaignDataBucket2FED4F6D","Arn"]},"/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CampaignMetricsTableC64D7CDE","Arn"]},{"Ref":"AWS::NoValue"}]},{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Ref":"AdPlatformAPIKeysC6796CCD"}}],"Version":"2012-10-17"},"policyName":"GoogleAdsFunctionServiceRoleDefaultPolicyBF6A9785","roles":[{"Ref":"GoogleAdsFunctionServiceRole11F2CADB"}]}}}}}}},"Code":{"id":"Code","path":"AdOptimizerAgentStack/GoogleAdsFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.220.0"},"children":{"Stage":{"id":"Stage","path":"AdOptimizerAgentStack/GoogleAdsFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.220.0"}},"AssetBucket":{"id":"AssetBucket","path":"AdOptimizerAgentStack/GoogleAdsFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.220.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/GoogleAdsFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-793323451177-us-east-1","s3Key":"f0370338278a371532ca2f3434067cbbe76e89865ea809774effb08df2d25d22.zip"},"environment":{"variables":{"BUCKET_NAME":{"Ref":"CampaignDataBucket2FED4F6D"},"METRICS_TABLE":{"Ref":"CampaignMetricsTableC64D7CDE"},"SECRETS_ARN":{"Ref":"AdPlatformAPIKeysC6796CCD"}}},"handler":"index.handler","memorySize":512,"role":{"Fn::GetAtt":["GoogleAdsFunctionServiceRole11F2CADB","Arn"]},"runtime":"python3.12","timeout":60}}}}},"MetaAdsFunction":{"id":"MetaAdsFunction","path":"AdOptimizerAgentStack/MetaAdsFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.220.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"AdOptimizerAgentStack/MetaAdsFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.220.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"AdOptimizerAgentStack/MetaAdsFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.220.0","metadata":[]}},"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/MetaAdsFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"AdOptimizerAgentStack/MetaAdsFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.220.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/MetaAdsFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CampaignDataBucket2FED4F6D","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["CampaignDataBucket2FED4F6D","Arn"]},"/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CampaignMetricsTableC64D7CDE","Arn"]},{"Ref":"AWS::NoValue"}]},{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Ref":"AdPlatformAPIKeysC6796CCD"}}],"Version":"2012-10-17"},"policyName":"MetaAdsFunctionServiceRoleDefaultPolicy8DA36093","roles":[{"Ref":"MetaAdsFunctionServiceRole148403D9"}]}}}}}}},"Code":{"id":"Code","path":"AdOptimizerAgentStack/MetaAdsFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.220.0"},"children":{"Stage":{"id":"Stage","path":"AdOptimizerAgentStack/MetaAdsFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.220.0"}},"AssetBucket":{"id":"AssetBucket","path":"AdOptimizerAgentStack/MetaAdsFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.220.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/MetaAdsFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-793323451177-us-east-1","s3Key":"9ea8d9aa9ba629ffdd639dbd543a1baa6ec7892f7f7ca0e3b04ab173576da0e4.zip"},"environment":{"variables":{"BUCKET_NAME":{"Ref":"CampaignDataBucket2FED4F6D"},"METRICS_TABLE":{"Ref":"CampaignMetricsTableC64D7CDE"},"SECRETS_ARN":{"Ref":"AdPlatformAPIKeysC6796CCD"}}},"handler":"index.handler","memorySize":512,"role":{"Fn::GetAtt":["MetaAdsFunctionServiceRole148403D9","Arn"]},"runtime":"python3.12","timeout":60}}}}},"AnalyticsFunction":{"id":"AnalyticsFunction","path":"AdOptimizerAgentStack/AnalyticsFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.220.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"AdOptimizerAgentStack/AnalyticsFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.220.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"AdOptimizerAgentStack/AnalyticsFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.220.0","metadata":[]}},"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/AnalyticsFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"AdOptimizerAgentStack/AnalyticsFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.220.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/AnalyticsFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CampaignDataBucket2FED4F6D","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["CampaignDataBucket2FED4F6D","Arn"]},"/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CampaignMetricsTableC64D7CDE","Arn"]},{"Ref":"AWS::NoValue"}]}],"Version":"2012-10-17"},"policyName":"AnalyticsFunctionServiceRoleDefaultPolicy0F4B1A8C","roles":[{"Ref":"AnalyticsFunctionServiceRole4C6FF659"}]}}}}}}},"Code":{"id":"Code","path":"AdOptimizerAgentStack/AnalyticsFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.220.0"},"children":{"Stage":{"id":"Stage","path":"AdOptimizerAgentStack/AnalyticsFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.220.0"}},"AssetBucket":{"id":"AssetBucket","path":"AdOptimizerAgentStack/AnalyticsFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.220.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/AnalyticsFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-793323451177-us-east-1","s3Key":"0a4a85c9daa2a36909b9d8b816f7346e6af621bac317460b66305f93ce191393.zip"},"environment":{"variables":{"BUCKET_NAME":{"Ref":"CampaignDataBucket2FED4F6D"},"METRICS_TABLE":{"Ref":"CampaignMetricsTableC64D7CDE"}}},"handler":"index.handler","memorySize":1024,"role":{"Fn::GetAtt":["AnalyticsFunctionServiceRole4C6FF659","Arn"]},"runtime":"python3.12","timeout":90}}}}},"BudgetOptimizerFunction":{"id":"BudgetOptimizerFunction","path":"AdOptimizerAgentStack/BudgetOptimizerFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.220.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"AdOptimizerAgentStack/BudgetOptimizerFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.220.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"AdOptimizerAgentStack/BudgetOptimizerFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.220.0","metadata":[]}},"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/BudgetOptimizerFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"AdOptimizerAgentStack/BudgetOptimizerFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.220.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/BudgetOptimizerFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CampaignDataBucket2FED4F6D","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["CampaignDataBucket2FED4F6D","Arn"]},"/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CampaignMetricsTableC64D7CDE","Arn"]},{"Ref":"AWS::NoValue"}]}],"Version":"2012-10-17"},"policyName":"BudgetOptimizerFunctionServiceRoleDefaultPolicy46985B4B","roles":[{"Ref":"BudgetOptimizerFunctionServiceRole76BFAA9E"}]}}}}}}},"Code":{"id":"Code","path":"AdOptimizerAgentStack/BudgetOptimizerFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.220.0"},"children":{"Stage":{"id":"Stage","path":"AdOptimizerAgentStack/BudgetOptimizerFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.220.0"}},"AssetBucket":{"id":"AssetBucket","path":"AdOptimizerAgentStack/BudgetOptimizerFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.220.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/BudgetOptimizerFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-793323451177-us-east-1","s3Key":"56011a5bf36b6f85a00462f349820a8ac037c3ebf14348a8c46131aa2662c886.zip"},"environment":{"variables":{"BUCKET_NAME":{"Ref":"CampaignDataBucket2FED4F6D"},"METRICS_TABLE":{"Ref":"CampaignMetricsTableC64D7CDE"}}},"handler":"index.handler","memorySize":512,"role":{"Fn::GetAtt":["BudgetOptimizerFunctionServiceRole76BFAA9E","Arn"]},"runtime":"python3.12","timeout":60}}}}},"StorageFunction":{"id":"StorageFunction","path":"AdOptimizerAgentStack/StorageFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.220.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"AdOptimizerAgentStack/StorageFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.220.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"AdOptimizerAgentStack/StorageFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.220.0","metadata":[]}},"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/StorageFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"AdOptimizerAgentStack/StorageFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.220.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/StorageFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CampaignDataBucket2FED4F6D","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["CampaignDataBucket2FED4F6D","Arn"]},"/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CampaignMetricsTableC64D7CDE","Arn"]},{"Ref":"AWS::NoValue"}]}],"Version":"2012-10-17"},"policyName":"StorageFunctionServiceRoleDefaultPolicy54CAC808","roles":[{"Ref":"StorageFunctionServiceRole697D58EA"}]}}}}}}},"Code":{"id":"Code","path":"AdOptimizerAgentStack/StorageFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.220.0"},"children":{"Stage":{"id":"Stage","path":"AdOptimizerAgentStack/StorageFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.220.0"}},"AssetBucket":{"id":"AssetBucket","path":"AdOptimizerAgentStack/StorageFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.220.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/StorageFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-793323451177-us-east-1","s3Key":"25aaec29de8fa255098dec0a1d8fd5760dad0c19bbf291f26a5b22fb3d8e88c8.zip"},"environment":{"variables":{"BUCKET_NAME":{"Ref":"CampaignDataBucket2FED4F6D"},"METRICS_TABLE":{"Ref":"CampaignMetricsTableC64D7CDE"}}},"handler":"index.handler","role":{"Fn::GetAtt":["StorageFunctionServiceRole697D58EA","Arn"]},"runtime":"python3.12","timeout":30}}}}},"BedrockAgentRole":{"id":"BedrockAgentRole","path":"AdOptimizerAgentStack/BedrockAgentRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.220.0","metadata":[]},"children":{"ImportBedrockAgentRole":{"id":"ImportBedrockAgentRole","path":"AdOptimizerAgentStack/BedrockAgentRole/ImportBedrockAgentRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.220.0","metadata":[]}},"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/BedrockAgentRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"bedrock.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AmazonBedrockFullAccess"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"AdOptimizerAgentStack/BedrockAgentRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.220.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AdOptimizerAgentStack/BedrockAgentRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"lambda:InvokeFunction","Effect":"Allow","Resource":[{"Fn::GetAtt":["GoogleAdsFunctionA96CDAD3","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["GoogleAdsFunctionA96CDAD3","Arn"]},":*"]]}]},{"Action":"lambda:InvokeFunction","Effect":"Allow","Resource":[{"Fn::GetAtt":["MetaAdsFunction54F22D99","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["MetaAdsFunction54F22D99","Arn"]},":*"]]}]},{"Action":"lambda:InvokeFunction","Effect":"Allow","Resource":[{"Fn::GetAtt":["AnalyticsFunctionFF8C31E8","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AnalyticsFunctionFF8C31E8","Arn"]},":*"]]}]},{"Action":"lambda:InvokeFunction","Effect":"Allow","Resource":[{"Fn::GetAtt":["BudgetOptimizerFunction4A1C8FF7","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["BudgetOptimizerFunction4A1C8FF7","Arn"]},":*"]]}]},{"Action":"lambda:InvokeFunction","Effect":"Allow","Resource":[{"Fn::GetAtt":["StorageFunction2187EE63","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["StorageFunction2187EE63","Arn"]},":*"]]}]}],"Version":"2012-10-17"},"policyName":"BedrockAgentRoleDefaultPolicy1462CD5B","roles":[{"Ref":"BedrockAgentRole7C982E0C"}]}}}}}}},"AdOptimizerAgent":{"id":"AdOptimizerAgent","path":"AdOptimizerAgentStack/AdOptimizerAgent","constructInfo":{"fqn":"aws-cdk-lib.aws_bedrock.CfnAgent","version":"2.220.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Bedrock::Agent","aws:cdk:cloudformation:props":{"agentName":"ad-optimizer-agent","agentResourceRoleArn":{"Fn::GetAtt":["BedrockAgentRole7C982E0C","Arn"]},"description":"AI Advertisement Optimization Agent for Small Businesses","foundationModel":"amazon.nova-pro-v1:0","idleSessionTtlInSeconds":1800,"instruction":"You are an expert digital advertising optimization agent for small businesses.\nYour role is to autonomously optimize Google Ads and Meta Ads campaigns to maximize ROI.\n\nYou have access to five tools:\n1. google_ads: Manage Google Ads campaigns (get metrics, adjust bids, update budgets, pause/activate ads)\n2. meta_ads: Manage Meta Ads campaigns (get metrics, adjust bids, update budgets, pause/activate ads)\n3. analytics: Analyze campaign performance, identify trends, and predict outcomes\n4. budget_optimizer: Optimize budget allocation across campaigns and platforms\n5. storage: Store insights, decisions, and performance history\n\nYour responsibilities:\n- Monitor campaign performance continuously\n- Identify underperforming ads and campaigns\n- Detect ad fatigue, market changes, and competitor actions\n- Automatically adjust bids, budgets, and targeting\n- Test ad creatives and scale winners\n- Reallocate budget to high-performing campaigns\n- Provide actionable insights and recommendations\n\nUse your reasoning capabilities to:\n- Understand business goals and constraints\n- Analyze multi-dimensional performance data\n- Make data-driven optimization decisions\n- Adapt to market volatility and platform changes\n- Balance short-term performance with long-term strategy\n- Explain your decisions clearly to business owners\n\nAlways prioritize ROI, cost-efficiency, and sustainable growth. Think strategically before taking action."}}},"AgentId":{"id":"AgentId","path":"AdOptimizerAgentStack/AgentId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.220.0"}},"AgentArn":{"id":"AgentArn","path":"AdOptimizerAgentStack/AgentArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.220.0"}},"CampaignDataBucketName":{"id":"CampaignDataBucketName","path":"AdOptimizerAgentStack/CampaignDataBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.220.0"}},"MetricsTableName":{"id":"MetricsTableName","path":"AdOptimizerAgentStack/MetricsTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.220.0"}},"APIKeysSecretArn":{"id":"APIKeysSecretArn","path":"AdOptimizerAgentStack/APIKeysSecretArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.220.0"}},"GoogleAdsFunctionArn":{"id":"GoogleAdsFunctionArn","path":"AdOptimizerAgentStack/GoogleAdsFunctionArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.220.0"}},"MetaAdsFunctionArn":{"id":"MetaAdsFunctionArn","path":"AdOptimizerAgentStack/MetaAdsFunctionArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.220.0"}},"AnalyticsFunctionArn":{"id":"AnalyticsFunctionArn","path":"AdOptimizerAgentStack/AnalyticsFunctionArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.220.0"}},"BudgetOptimizerFunctionArn":{"id":"BudgetOptimizerFunctionArn","path":"AdOptimizerAgentStack/BudgetOptimizerFunctionArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.220.0"}},"StorageFunctionArn":{"id":"StorageFunctionArn","path":"AdOptimizerAgentStack/StorageFunctionArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.220.0"}},"NextSteps":{"id":"NextSteps","path":"AdOptimizerAgentStack/NextSteps","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.220.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"AdOptimizerAgentStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"AdOptimizerAgentStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.220.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"AdOptimizerAgentStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.220.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"AdOptimizerAgentStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.220.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}